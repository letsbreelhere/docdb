Currently some horrendous code from a weekend hack.
